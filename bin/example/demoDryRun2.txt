#
# This demo shows dry-run will report
# - condition pass/fail: 
#    + livejournal.txt,some lines will not pass the condition
# - show performance
#
####

# prepare graph schema 
drop graph wj cascade

create vertex blogger(primary_id id UINT32)
create undirected edge friendship(from blogger, to blogger)
create Graph wj(blogger, friendship)

#create loading job
drop job wjj

create loading job wjj for graph wj
  load "/vagrant/data/testdata/livejournal.txt" to edge friendship values($0, $1) where GreaterThan($1, 10000) using separator="\t", header="false";
end

# set dry-run session parameters
set dryrun_report_interval = 100000
set dryrun_report_startline = 1000

clear graph store

run job -dryrun wjj

